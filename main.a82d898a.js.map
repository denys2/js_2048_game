{"version":3,"sources":["scripts/main.js"],"names":["columns","rows","document","querySelectorAll","cells","cellsInRow","map","row","startCellVelues","startButton","querySelector","startMessage","loseMessage","winMessage","gameScore","i","j","push","children","clearCells","started","rotated","randomCellFill","length","randomIndex","someArr","Math","floor","random","randomCell","randomValue","classList","innerText","splice","indexOf","start","style","restart","add","forEach","cell","className","isMergePossible","wholeField","line","upArrow","rotateCells","reverse","downArrow","rightArrow","leftArrow","arrowMove","direction","remove","removeAttribute","deleteElement","element","rotateElement","curr","prev","cellMerge","value","dataset","blocked","moveAllowed","includes","mergeAllowed","addEventListener","evt","key","preventDefault"],"mappings":"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","file":"main.a82d898a.js","sourceRoot":"..\\src","sourcesContent":["'use strict';\r\n\r\nconst columns = [[], [], [], []];\r\nconst rows = [...document.querySelectorAll('.field-row')];\r\nconst cells = document.querySelectorAll('.field-cell');\r\nconst cellsInRow = rows.map((row) => [...row.querySelectorAll('.field-cell')]);\r\nconst startCellVelues = [2, 2, 2, 2, 2, 2, 2, 2, 2, 4];\r\n\r\nconst startButton = document.querySelector('.start');\r\nconst startMessage = document.querySelector('.message-start');\r\nconst loseMessage = document.querySelector('.message-lose');\r\nconst winMessage = document.querySelector('.message-win');\r\nconst gameScore = document.querySelector('.game-score');\r\n\r\nfor (let i = 0; i < 4; i++) {\r\n  for (let j = 0; j < 4; j++) {\r\n    columns[j].push(rows[i].children[j]);\r\n  }\r\n}\r\n\r\nlet clearCells = [...cells];\r\nlet started = false;\r\nlet rotated = false;\r\n\r\nfunction randomCellFill() {\r\n  if (!clearCells.length) {\r\n    return;\r\n  }\r\n\r\n  const randomIndex = (someArr) => Math.floor(Math.random() * someArr.length);\r\n  const randomCell = clearCells[randomIndex(clearCells)];\r\n  const randomValue = startCellVelues[randomIndex(startCellVelues)];\r\n\r\n  randomCell.classList = (`field-cell field-cell--${randomValue}`);\r\n  randomCell.innerText = randomValue;\r\n\r\n  clearCells.splice(clearCells.indexOf(randomCell), 1);\r\n}\r\n\r\nconst start = () => {\r\n  startMessage.style = 'display: none;';\r\n  startButton.classList = 'button restart';\r\n  startButton.innerText = 'Restart';\r\n\r\n  randomCellFill();\r\n  randomCellFill();\r\n  started = true;\r\n};\r\n\r\nconst restart = () => {\r\n  loseMessage.classList.add('hidden');\r\n  winMessage.classList.add('hidden');\r\n  clearCells = [...cells];\r\n  gameScore.innerText = 0;\r\n\r\n  cells.forEach(cell => {\r\n    cell.innerText = '';\r\n    cell.className = 'field-cell';\r\n  });\r\n\r\n  randomCellFill();\r\n  randomCellFill();\r\n};\r\n\r\nfunction isMergePossible() {\r\n  const wholeField = [...cellsInRow, ...columns];\r\n\r\n  for (const line of wholeField) {\r\n    for (let i = 0; i < 3; i++) {\r\n      if (line[i].innerText === line[i + 1].innerText) {\r\n        return true;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction upArrow() {\r\n  for (const column of columns) {\r\n    rotateCells([...column].reverse());\r\n  }\r\n}\r\n\r\nfunction downArrow() {\r\n  for (const column of columns) {\r\n    rotateCells(column);\r\n  }\r\n}\r\n\r\nfunction rightArrow() {\r\n  for (const row of cellsInRow) {\r\n    rotateCells(row);\r\n  }\r\n}\r\n\r\nfunction leftArrow() {\r\n  for (const row of cellsInRow) {\r\n    rotateCells([...row].reverse());\r\n  }\r\n}\r\n\r\nfunction arrowMove(direction) {\r\n  if (!clearCells.length && !isMergePossible()) {\r\n    loseMessage.classList.remove('hidden');\r\n  }\r\n\r\n  switch (direction) {\r\n    case 'ArrowUp':\r\n      upArrow();\r\n      break;\r\n    case 'ArrowDown':\r\n      downArrow();\r\n      break;\r\n    case 'ArrowRight':\r\n      rightArrow();\r\n      break;\r\n    case 'ArrowLeft':\r\n      leftArrow();\r\n      break;\r\n  }\r\n\r\n  cells.forEach(cell => {\r\n    cell.removeAttribute('data-blocked');\r\n  });\r\n}\r\n\r\nfunction deleteElement(element) {\r\n  element.innerText = '';\r\n  element.className = 'field-cell';\r\n  clearCells.push(element);\r\n}\r\n\r\nfunction rotateElement(curr, prev) {\r\n  curr.innerText = prev.innerText;\r\n  curr.className = prev.className;\r\n  clearCells.splice(clearCells.indexOf(curr), 1);\r\n  deleteElement(prev);\r\n}\r\n\r\nfunction cellMerge(curr, prev) {\r\n  const value = curr.innerText * 2;\r\n\r\n  curr.innerText = value;\r\n  curr.className = `field-cell field-cell--${value}`;\r\n  gameScore.innerText = +gameScore.innerText + value;\r\n  deleteElement(prev);\r\n\r\n  curr.dataset.blocked = true;\r\n  prev.dataset.blocked = true;\r\n\r\n  if (value === 2048) {\r\n    winMessage.classList.remove('hidden');\r\n  }\r\n}\r\n\r\nfunction rotateCells(line) {\r\n  for (let i = 3; i > 0; i--) {\r\n    const moveAllowed = clearCells.includes(line[i])\r\n      && !clearCells.includes(line[i - 1]);\r\n\r\n    const mergeAllowed = line[i].innerText === line[i - 1].innerText\r\n      && line[i].innerText.length\r\n      && !line[i - 1].dataset.blocked;\r\n\r\n    if ((mergeAllowed || moveAllowed) && !rotated) {\r\n      rotated = true;\r\n    }\r\n\r\n    if (mergeAllowed) {\r\n      cellMerge(line[i], line[i - 1]);\r\n      rotateCells(line);\r\n    }\r\n\r\n    if (moveAllowed) {\r\n      rotateElement(line[i], line[i - 1]);\r\n      rotateCells(line);\r\n    }\r\n  }\r\n}\r\n\r\ndocument.addEventListener('keydown', (evt) => {\r\n  const arrowDirections = ['ArrowUp', 'ArrowDown', 'ArrowLeft', 'ArrowRight'];\r\n\r\n  if (arrowDirections.includes(evt.key)) {\r\n    evt.preventDefault();\r\n    arrowMove(evt.key);\r\n\r\n    if (rotated) {\r\n      randomCellFill();\r\n      rotated = false;\r\n    }\r\n  }\r\n});\r\n\r\nstartButton.addEventListener('click', () => {\r\n  if (!started) {\r\n    start();\r\n  } else {\r\n    restart();\r\n  }\r\n});\r\n"]}